{
    "action.email": "0",
    "action.email.includeEntities": "0",
    "action.email.show_password": "1",
    "action.itsi_event_generator": "1",
    "action.itsi_event_generator.param.description": "%itsiDescription%",
    "action.itsi_event_generator.param.drilldown_title": "Episode Attribute Analysis",
    "action.itsi_event_generator.param.drilldown_uri": "/app/itsi/itsi_episode_attribute_analysis?form.itsi_group_id=%itsi_group_id%",
    "action.itsi_event_generator.param.entity_lookup_field": "entity_name",
    "action.itsi_event_generator.param.event_identifier_fields": "groupingid",
    "action.itsi_event_generator.param.itsi_instruction": "%itsi_instruction%",
    "action.itsi_event_generator.param.meta_data": "{}",
    "action.itsi_event_generator.param.search_type": "basic",
    "action.itsi_event_generator.param.severity": "%severity_id%",
    "action.itsi_event_generator.param.title": "Episode Monitoring Alert: %alert_trigger_reason%",
    "action.rss": "0",
    "action.script": "0",
    "actions": "itsi_event_generator",
    "alert.digest_mode": "1",
    "alert.expires": "24h",
    "alert.severity": "3",
    "alert.suppress": "0",
    "alert.track": "0",
    "alert_comparator": "greater than",
    "alert_threshold": "0",
    "alert_type": "number of events",
    "allow_skew": "0",
    "auto_summarize": "0",
    "cron_schedule": "*/5 * * * *",
    "defer_scheduled_searchable_idxc": "1",
    "description": "v25 - Set the episode severity to match the highest current alarm severity.  And if all the alarms are clear, and if 10min of inactivity have been observed, close the episode.",
    "disabled": "0",
    "dispatch.allow_partial_results": "1",
    "dispatch.auto_cancel": "0",
    "dispatch.auto_pause": "0",
    "dispatch.buckets": "0",
    "dispatch.earliest_time": "-9h",
    "dispatch.latest_time": "now",
    "dispatch.lookups": "1",
    "dispatch.max_count": "500000",
    "dispatch.max_time": "0",
    "dispatch.rate_limit_retry": "0",
    "dispatch.reduce_freq": "10",
    "dispatch.rt_backfill": "0",
    "dispatch.sample_ratio": "1",
    "dispatch.spawn_process": "1",
    "dispatch.time_format": "%FT%T.%Q%:z",
    "dispatch.ttl": "2p",
    "dispatchAs": "owner",
    "eai:acl": {
        "app": "itsi",
        "can_change_perms": "1",
        "can_list": "1",
        "can_share_app": "1",
        "can_share_global": "1",
        "can_share_user": "1",
        "can_write": "1",
        "modifiable": "1",
        "owner": "admin",
        "perms": {
            "delete": [
                "itoa_admin",
                "itoa_team_admin"
            ],
            "read": [
                "*"
            ],
            "write": [
                "itoa_admin",
                "itoa_team_admin"
            ]
        },
        "removable": "1",
        "sharing": "global"
    },
    "is_scheduled": "1",
    "is_visible": "1",
    "key": "Episode Monitoring - Set Episode to Highest Alarm Severity",
    "max_concurrent": "1",
    "name": "Episode Monitoring - Set Episode to Highest Alarm Severity",
    "next_scheduled_time": "2025-05-06 13:30:00 UTC",
    "precalculate_required_fields_for_alerts": "1",
    "qualifiedSearch": "search `itsi_event_management_group_index` groupingid!=\"Episode Monitoring Alert\" itsi_policy_id!=\"itsi_default_policy\"\n| eval alarm_id=coalesce(signature . src . subcomponent, \"-\") . event_identifier_string \n| stats latest(_time) as _time, latest(event_id) as event_id, latest(itsi_policy_id) as itsi_policy_id, latest(severity) as current_alarm_severity by itsi_group_id, alarm_id \n| `filter_to_open_episodes` \n| stats latest(_time) as _time, max(current_alarm_severity) as highest_alarm_severity, latest(itsi_group_severity) as itsi_group_severity, latest(itsi_policy_id) as itsi_policy_id, latest(itsi_group_status) as itsi_group_status, latest(event_id) as event_id by itsi_group_id \n| eval inactive_time=now()-_time \n| eval set_episode_severity=case((highest_alarm_severity!=itsi_group_severity AND (inactive_time>(60*1))), highest_alarm_severity) \n| eval set_episode_status=case((highest_alarm_severity=2 AND (inactive_time>(60*1))), 5) \n| eval alert_trigger_reason=case(\n    set_episode_status=5, \"Closing episode because all alarms have cleared\", \n    isnotnull(set_episode_severity), \"Setting episode severity to match highest alarm severity (\" . highest_alarm_severity . \")\", \n    isnotnull(set_episode_status), \"Setting epsiode status to \" . set_episode_status\n    ) \n| where isnotnull(alert_trigger_reason) \n| fields event_id itsi_group_id itsi_policy_id set_episode* is_alert_trigger alert_trigger_reason groupingid \n| join type=inner event_id \n    [ search `itsi_event_management_index`] \n| `remove_itsi_notable_event_reserved_fields` \n| eval entity_name = coalesce(entity_name, src) \n| eval severity_id=coalesce(set_episode_severity, 2) \n| eval is_alert_trigger=1, groupingid=\"Episode Monitoring Alert\" \n| eval itsiDescription = alert_trigger_reason \n| eval itsi_service_id=if(isnotnull(itsi_service_id), itsi_service_id, serviceid)\n| eval _time=now() \n| `apply_entity_lookup(entity_name)`| eval serviceid=coalesce(serviceid,itsi_service_id)\n| `get_service_name(serviceid,service_name)`",
    "realtime_schedule": "1",
    "restart_on_searchpeer_add": "1",
    "run_n_times": "0",
    "run_on_startup": "0",
    "schedule_as": "auto",
    "schedule_priority": "default",
    "schedule_window": "0",
    "search": "`itsi_event_management_group_index` groupingid!=\"Episode Monitoring Alert\" itsi_policy_id!=\"itsi_default_policy\"\n| eval alarm_id=coalesce(signature . src . subcomponent, \"-\") . event_identifier_string \n| stats latest(_time) as _time, latest(event_id) as event_id, latest(itsi_policy_id) as itsi_policy_id, latest(severity) as current_alarm_severity by itsi_group_id, alarm_id \n| `filter_to_open_episodes` \n| stats latest(_time) as _time, max(current_alarm_severity) as highest_alarm_severity, latest(itsi_group_severity) as itsi_group_severity, latest(itsi_policy_id) as itsi_policy_id, latest(itsi_group_status) as itsi_group_status, latest(event_id) as event_id by itsi_group_id \n| eval inactive_time=now()-_time \n| eval set_episode_severity=case((highest_alarm_severity!=itsi_group_severity AND (inactive_time>(60*1))), highest_alarm_severity) \n| eval set_episode_status=case((highest_alarm_severity=2 AND (inactive_time>(60*1))), 5) \n| eval alert_trigger_reason=case(\n    set_episode_status=5, \"Closing episode because all alarms have cleared\", \n    isnotnull(set_episode_severity), \"Setting episode severity to match highest alarm severity (\" . highest_alarm_severity . \")\", \n    isnotnull(set_episode_status), \"Setting epsiode status to \" . set_episode_status\n    ) \n| where isnotnull(alert_trigger_reason) \n| fields event_id itsi_group_id itsi_policy_id set_episode* is_alert_trigger alert_trigger_reason groupingid \n| join type=inner event_id \n    [ search `itsi_event_management_index`] \n| `remove_itsi_notable_event_reserved_fields` \n| eval entity_name = coalesce(entity_name, src) \n| eval severity_id=coalesce(set_episode_severity, 2) \n| eval is_alert_trigger=1, groupingid=\"Episode Monitoring Alert\" \n| eval itsiDescription = alert_trigger_reason \n| eval itsi_service_id=if(isnotnull(itsi_service_id), itsi_service_id, serviceid)\n| eval _time=now() \n| `apply_entity_lookup(entity_name)`| eval serviceid=coalesce(serviceid,itsi_service_id)\n| `get_service_name(serviceid,service_name)`",
    "sid": "Episode Monitoring - Set Episode to Highest Alarm Severity",
    "skip_scheduled_realtime_idxc": "0",
    "version": "0.0.41"
}